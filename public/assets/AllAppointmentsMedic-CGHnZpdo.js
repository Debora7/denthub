import{T as X,r as v,k as E,h as I,o as c,f as d,a as r,u as n,w as $,F as h,Z as fe,b as t,i as N,m as H,d as B,q as b,n as S,e as D,p as ee,g as z,t as g,s as he,x as xe}from"./app-m8O9x8db.js";import{_ as ye}from"./AuthenticatedLayout-oP7uY6wx.js";import{t as we}from"./toastr.min-sOBkje4z.js";import{P as te}from"./PrimaryButton-D-IF3Vpv.js";import{_ as ke,a as be}from"./Modal-90c__Ftz.js";import{_ as x}from"./InputError-mYeCkuLg.js";import{_ as y}from"./InputLabel-vZ1nCw19.js";import{_ as j}from"./TextInput-CdSXe7W9.js";import{_ as Se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-L9kXl_zd.js";const f=w=>(he("data-v-ca0f97b9"),w=w(),xe(),w),De={class:"py-12"},Te={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Ce={class:"mb-4"},Ae={class:"input-group mb-3"},Ve=f(()=>t("span",{class:"input-group-text",id:"basic-addon1",style:{"background-color":"white"}},[t("i",{class:"fas fa-search"})],-1)),Ie={class:"d-flex justify-content-between mb-3"},$e={class:"input-group"},Ne=f(()=>t("span",{class:"input-group-text",style:{"background-color":"white"}},"Data",-1)),Pe={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Me={class:"p-6 text-gray-900"},Oe={key:0,class:"overflow-x-auto"},Ue={class:"min-w-full divide-y divide-gray-200"},ze=f(()=>t("thead",{class:"bg-gray-50"},[t("tr",{class:"bg-gray-100"},[t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nume pacient "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Telefon "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Ora programării "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Serviciul "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Suma de plată "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Acțiuni ")])],-1)),qe={class:"bg-white divide-y divide-gray-200"},Fe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Le={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ee={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},He={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Be={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},je={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Re=["onClick"],We=f(()=>t("i",{class:"fas fa-check"},null,-1)),Ye=[We],Je=["onClick"],Ke=f(()=>t("i",{class:"fas fa-times"},null,-1)),Qe=[Ke],Ze={class:"d-flex justify-content-center align-items-center mt-4"},Ge={class:"pagination mb-0 custom-pagination"},Xe=["onClick"],et=["value"],tt=["value"],st={key:1},ot=f(()=>t("div",{class:"p-6 text-gray-900"}," Nu aveți programări făcute momentan. Aici veți putea vedea toate programările făcute de dvs. sau clienți. ",-1)),at=[ot],nt={class:"p-6"},lt={class:"mt-4"},rt={class:"mt-4"},it={class:"flex items-center"},ct={class:"mt-4"},dt=f(()=>t("option",{value:""},"Selectează medicul",-1)),ut=["value"],mt={key:0,class:"mt-4"},pt=f(()=>t("option",{value:""},"Selectează serviciul",-1)),_t=["value"],gt={key:1,class:"mt-4"},vt=["min","max"],ft={key:0,class:"text-danger"},ht={key:2,class:"mt-4"},xt={class:"mt-2"},yt=["onClick"],wt={class:"flex items-center justify-end mt-4"},kt={__name:"AllAppointmentsMedic",props:{appointments:Array,allAppointments:Array,doctors:Array},setup(w){const T=w,P=X({id:0}),a=X({name:"",email:"",phone:"",doctor:"",consult:"",date:"",time:"",consult_time:""}),R=v([]),se=o=>{const s=T.doctors.find(e=>e.id===o);R.value=s?s.consults:[]};E(()=>a.doctor,o=>{se(o),a.consult="",a.date="",k.value=[]}),E(()=>a.consult,()=>{a.date="",k.value=[]});const oe=I(()=>{const o=new Date,s=new Date(o);return s.setDate(o.getDate()+1),s.toISOString().split("T")[0]}),ae=I(()=>{const o=new Date;return o.setFullYear(o.getFullYear()+1),o.toISOString().split("T")[0]}),W=o=>{var m;if(!o)return!0;const e=new Date(o).toLocaleDateString("ro-RO",{weekday:"long"}),l=e.charAt(0).toUpperCase()+e.slice(1),i=a.doctor,u=T.doctors.find(L=>L.id===i);if(!u)return console.error("Doctor not found"),!1;const _=u.working_days;return((m=JSON.parse(_)[l])==null?void 0:m.enabled)||!1},k=v([]);E(()=>a.date,o=>{if(o){const s=a.doctor,e=T.doctors.find(m=>m.id===s),l=a.consult,i=e.consults.find(m=>m.id===l);a.consult_time=i.consult_time;const u=i.consult_time,_=e.working_days;ne(JSON.parse(_),u)}});const ne=(o,s)=>{const l=new Date(a.date).toLocaleDateString("ro-RO",{weekday:"long"}),i=l.charAt(0).toUpperCase()+l.slice(1),u=o[i];if(!u||!u.enabled){k.value=[];return}const _=[],m=Y(u.start_time),L=Y(u.end_time);let U=new Date(m);const ve=re(s);for(;U<L;)_.push(ie(U)),U.setMinutes(U.getMinutes()+ve.minutes);k.value=le(T.allAppointments,a,_)},le=(o,s,e)=>{let l=[...e];return o.forEach(i=>{if(i.doctor_id===s.doctor&&i.consult_id===s.consult&&new Date(i.appointment_date).toISOString().split("T")[0]===s.date){const u=new Date(i.appointment_date).toTimeString().split(":")[0]+":"+new Date(i.appointment_date).toTimeString().split(":")[1];l=l.filter(_=>_!==u)}else if(i.doctor_id===s.doctor&&new Date(i.appointment_date).toISOString().split("T")[0]===s.date){const u=new Date(i.appointment_date).toTimeString().split(":")[0]+":"+new Date(i.appointment_date).toTimeString().split(":")[1],_=new Date(i.appointment_date_end).toTimeString().split(":")[0]+":"+new Date(i.appointment_date_end).toTimeString().split(":")[1];l=l.filter(m=>m<u||m>=_)}}),l},Y=o=>{const[s,e]=o.split(":").map(Number),l=new Date;return l.setHours(s,e,0,0),l},re=o=>{const[s,e,l]=o.split(":").map(Number);return{hours:s,minutes:e,seconds:l}},ie=o=>o.toTimeString().slice(0,5),J=v(null),ce=o=>{J.value=o,a.time=o},M=v(!1),de=o=>{const s=new Date(o),e=String(s.getHours()).padStart(2,"0"),l=String(s.getMinutes()).padStart(2,"0");return`${e}:${l}`},p=v(1),K=[15,25,50,100],C=v(K[0]),q=v(""),F=v(new Date().toISOString().substr(0,10)),Q=I(()=>T.appointments.filter(o=>new Date(o.appointment_date).toISOString().substr(0,10)===F.value&&o.user.name.toLowerCase().includes(q.value.toLowerCase()))),Z=I(()=>{const o=(p.value-1)*C.value,s=o+C.value;return Q.value.slice(o,s)}),A=I(()=>Math.ceil(Q.value.length/C.value)),V=o=>{o>=1&&o<=A.value&&(p.value=o)},ue=o=>{C.value=parseInt(o.target.value),p.value=1},me=o=>{P.id=o,P.post(route("consult.medic.honored"),{onFinish:()=>{O("Programarea a fost marcată ca fiind onorată")}})},O=(o,s="success")=>{we[s](o)},pe=o=>{P.id=o,P.post(route("consult.medic.missed"),{onFinish:()=>{O("Programarea a fost marcată ca fiind anulată")}})},_e=()=>{M.value=!0},G=()=>{M.value=!1,a.reset(),a.errors={},k.value=[]},ge=()=>{a.post(route("consult.medic.consult.store"),{onSuccess:()=>{M.value=!1,a.reset(),O("Programarea a fost salvată")},onError:()=>{O("Rezolvă problemele înainte de a salva.","error")}})};return(o,s)=>(c(),d(h,null,[r(n(fe),{title:"Programari"}),r(ye,null,{default:$(()=>[t("div",De,[t("div",Te,[t("div",Ce,[t("div",Ae,[Ve,N(t("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=e=>q.value=e),class:"form-control",placeholder:"Caută după numele pacientului"},null,512),[[H,q.value]])]),t("div",Ie,[t("div",$e,[Ne,N(t("input",{type:"date","onUpdate:modelValue":s[1]||(s[1]=e=>F.value=e),class:"form-control"},null,512),[[H,F.value]]),r(te,{class:"ms-2",style:{"border-radius":"7px"},onClick:_e},{default:$(()=>[B(" Adaugă o programare ")]),_:1})])])]),t("div",Pe,[t("div",Me,[Z.value.length>0?(c(),d("div",Oe,[t("table",Ue,[ze,t("tbody",qe,[(c(!0),d(h,null,b(Z.value,e=>(c(),d("tr",{key:e.id},[t("td",Fe,g(e.user.name),1),t("td",Le,g(e.user.phone??"-"),1),t("td",Ee,g(de(e.appointment_date)),1),t("td",He,g(e.consult.service),1),t("td",Be,g(e.consult.price)+" Lei ",1),t("td",je,[t("button",{class:"bg-green-500 text-white px-2 py-1",style:{"border-radius":"50%",width:"32px",height:"32px"},onClick:l=>me(e.id)},Ye,8,Re),t("button",{class:"bg-red-500 text-white px-2 py-1 ml-2",style:{"border-radius":"50%",width:"32px",height:"32px"},onClick:l=>pe(e.id)},Qe,8,Je)])]))),128))])]),t("nav",Ze,[t("ul",Ge,[t("li",{class:S(["page-item",{disabled:p.value===1}])},[t("a",{class:"page-link",href:"#",onClick:s[2]||(s[2]=D(e=>V(1),["prevent"]))}," << ")],2),t("li",{class:S(["page-item",{disabled:p.value===1}])},[t("a",{class:"page-link",href:"#",onClick:s[3]||(s[3]=D(e=>V(p.value-1),["prevent"]))}," < ")],2),(c(!0),d(h,null,b(A.value,e=>(c(),d("li",{class:S(["page-item",{active:e===p.value}]),key:e},[t("a",{class:"page-link",href:"#",onClick:D(l=>V(e),["prevent"])},g(e),9,Xe)],2))),128)),t("li",{class:S(["page-item",{disabled:p.value===A.value}])},[t("a",{class:"page-link",href:"#",onClick:s[4]||(s[4]=D(e=>V(p.value+1),["prevent"]))}," > ")],2),t("li",{class:S(["page-item",{disabled:p.value===A.value}])},[t("a",{class:"page-link",href:"#",onClick:s[5]||(s[5]=D(e=>V(A.value),["prevent"]))}," >> ")],2)]),t("select",{class:"form-select form-select-sm ms-3",onChange:ue,value:C.value,style:{width:"auto"}},[(c(),d(h,null,b(K,e=>t("option",{key:e,value:e},g(e),9,tt)),64))],40,et)])])):(c(),d("div",st,at))])])])]),r(ke,{show:M.value,onClose:G},{default:$(()=>[t("div",nt,[t("form",{onSubmit:D(ge,["prevent"])},[t("div",null,[r(y,{for:"name",value:"Nume complet",required:!0}),r(j,{id:"name",type:"text",class:"mt-1 block w-full",modelValue:n(a).name,"onUpdate:modelValue":s[6]||(s[6]=e=>n(a).name=e),autofocus:"",autocomplete:"name"},null,8,["modelValue"]),r(x,{class:"mt-2",message:n(a).errors.name},null,8,["message"])]),t("div",lt,[r(y,{for:"email",value:"Email",required:!0}),r(j,{id:"email",type:"email",class:"mt-1 block w-full",modelValue:n(a).email,"onUpdate:modelValue":s[7]||(s[7]=e=>n(a).email=e),autocomplete:"username"},null,8,["modelValue"]),r(x,{class:"mt-2",message:n(a).errors.email},null,8,["message"])]),t("div",rt,[r(y,{for:"phone",value:"Telefon"}),t("div",it,[r(j,{id:"phone",type:"text",class:"mt-1 block w-full",modelValue:n(a).phone,"onUpdate:modelValue":s[8]||(s[8]=e=>n(a).phone=e),maxlength:"10",onInput:s[9]||(s[9]=e=>n(a).phone=n(a).phone.replace(/\D/g,""))},null,8,["modelValue"])]),r(x,{class:"mt-2",message:n(a).errors.phone},null,8,["message"])]),t("div",ct,[r(y,{for:"doctor",value:"Medic",required:!0}),N(t("select",{id:"doctor",class:"mt-1 block w-full","onUpdate:modelValue":s[10]||(s[10]=e=>n(a).doctor=e),style:{"border-radius":"5px","border-color":"lightgray"}},[dt,(c(!0),d(h,null,b(w.doctors,e=>(c(),d("option",{key:e.id,value:e.id},g(e.name),9,ut))),128))],512),[[ee,n(a).doctor]]),r(x,{class:"mt-2",message:n(a).errors.doctor},null,8,["message"])]),n(a).doctor?(c(),d("div",mt,[r(y,{for:"consult",value:"Serviciu",required:!0}),N(t("select",{id:"consult",class:"mt-1 block w-full","onUpdate:modelValue":s[11]||(s[11]=e=>n(a).consult=e),style:{"border-radius":"5px","border-color":"lightgray"}},[pt,(c(!0),d(h,null,b(R.value,e=>(c(),d("option",{key:e.id,value:e.id},g(e.service),9,_t))),128))],512),[[ee,n(a).consult]]),r(x,{class:"mt-2",message:n(a).errors.consult},null,8,["message"])])):z("",!0),n(a).consult?(c(),d("div",gt,[r(y,{for:"appointmentDate",value:"Selectează data programării",required:!0}),N(t("input",{type:"date",id:"appointmentDate","onUpdate:modelValue":s[12]||(s[12]=e=>n(a).date=e),min:oe.value,max:ae.value,class:"mt-1 block w-full p-2 border border-gray-300 rounded-md"},null,8,vt),[[H,n(a).date]]),r(x,{class:"mt-2",message:n(a).errors.date},null,8,["message"]),W(n(a).date)?z("",!0):(c(),d("p",ft," Medicul nu are program în această zi. "))])):z("",!0),n(a).date&&W(n(a).date)?(c(),d("div",ht,[r(y,{value:"Selectează ora programării",required:!0}),t("div",xt,[(c(!0),d(h,null,b(k.value,e=>(c(),d("span",{key:e,class:S(["badge",{"badge-selected":e===J.value}]),onClick:l=>ce(e)},g(e),11,yt))),128))]),r(x,{class:"mt-2",message:n(a).errors.time},null,8,["message"])])):z("",!0),t("div",wt,[r(te,{type:"submit"},{default:$(()=>[B("Salvează")]),_:1}),r(be,{onClick:G,class:"ms-3"},{default:$(()=>[B(" Închide ")]),_:1})])],32)])]),_:1},8,["show"])]),_:1})],64))}},Pt=Se(kt,[["__scopeId","data-v-ca0f97b9"]]);export{Pt as default};
